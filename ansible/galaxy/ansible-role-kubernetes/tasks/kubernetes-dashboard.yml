---

- name: Kubernetes dashboard deployment folder
  become_user: "{{ ansible_user }}"
  file:
    path: $HOME/.kube/kubernetes-dasboard
    state: directory
  register: dashboard_deployment

- name: Copy kubernetes dashboard deployment configuration
  template:
    src: kubernetes-dashboard.yml.j2
    dest: "{{ dashboard_deployment.path}}/kubernetes-dashboard.yml"
    owner: "{{ ansible_user }}"
    group: "{{ ansible_user }}"

- name: Apply kubernetes dashboard deployment
  become_user: "{{ ansible_user }}"
  command: "kubectl apply -f {{ dashboard_deployment.path}}/kubernetes-dashboard.yml"
  register: kubernetes_dashboard_apply

- name: Kubernetes dashboard apply output
  debug:
    msg: "{{ kubernetes_dashboard_apply.stdout_lines }}"

